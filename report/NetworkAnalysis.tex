\section{Rete prodotti}\label{ReteProdotti}
L'analisi condotta sulla rete ha lo scopo di individuare gruppi di prodotti che interagiscono tra loro e di andare ad individuare quelli più strategici all'interno della rete tramite un'analisi di centralità. Nel seguito vengono descritte le scelte di costruzione della rete, definito il concetto di prodotto strategico ed infine presentate le analisi che partendo dalla globalità della rete scendono nei dettagli delle sottoreti più significative. 

\subsection{Costruzione rete}
Inizialmente sono state generate 3 reti diverse tenendo conto delle singole relazioni \textit{bought\_together}, \textit{also\_bought} e \textit{also\_viewed}. Da un studio generale è emerso che la relazione \textit{also\_viewed} risulti poco significativa per gli obiettivi preposti, per cui è stata scartata in quanto collega prodotti prettamente simili tra loro. Le relazioni di\textit{bought\_together} e \textit{also\_bought}, invece, permettono di portare alla luce prodotti diversi il cui impiego effettivo può dipendere l'uno dall'altro e ciò permette di stabilire se esistono prodotti particolarmente strategici all'interno della rete. Si è inoltre notato che le due relazioni in questione riportano spesso lo stesso prodotto come sia in \textit{bought\_together} che in \textit{also\_bought} e che inoltre la direzionalità della relazione \textit{also\_bought} sia indipendente da una temporalità di acquisto. \\
Al netto di queste motivazioni, è state considerato ragionevole effettuare un'unione delle due relazioni in un'unica relazione di acquisto adirezionale. 
\\\\
Una volta stabilito il nuovo insieme di relazioni è stata necessaria una fase di pulizia per andare a scartare gli archi e i nodi superflui per la costruzione della rete. Per prima cosa è stato necessario rimuovere tutti gli archi di cui non sono presenti le informazioni relative al nodo destinazione. Dopodichè, sono state unite tutte le relazioni simmetriche in quanto la direzionalità delle relazioni non è significativa ai fini di questa analisi. Infine, sono stati rimossi dalla tabella dei prodotti tutti i nodi rimasti isolati dopo il filtraggio delle relazioni. Al termine del processo di pulizia si è passati da XXX a XXX per il numero di archi e da XXX a XXX per il numero di nodi. \\
A partire dal nuovo insieme di archi è stata quindi costruita la rete dei prodotti tramite un grafo non orientato.



\subsection{Concetti di prodotto centrale}
In questa analisi con il termine \textbf{prodotto strategico} si intende quel prodotto che, se pubblicizzato in base a quanto emerge dalla rete, può costituire delle vendite facili verso chi acquista altri prodotti correlati ad esso. \\
I prodotti strategici vengono individuati tramite il calcolo delle centralità dei nodi. In particolare, è la \textit{degree centrality} quella che permette di individuare i prodotti che hanno maggiori interazione con altri. Trovare un prodotto con centralità di grado alta significa trovare un prodotto con un ampio vicinato. Per questo motivo se si dovesse scegliere quali prodotti pubblicizzare a partire da uno specifico nodo, una scelta strategica potrebbe essere quella di dare priorità ai prodotti del vicinato con grado più alto. Questa misura di centralità sarà particolarmente per stabilire i prodotti più importanti all'interno delle sottoreti relative a categorie e communities. \\\\
% Una misura di centralità che può essere utile per un'analisi sulla rete nella sua globalità è quella della \textit{closeness centrality}. Tramite essa è possibile individuare i prodotti meglio posizionati per influenzare la sottorete più velocemente.
    
%TODO: spiegare cosa sono i prodotti centrali qui... closeness e degree sono stessi prodotti, magari controllare.. in caso affermativo si possono dire le seguenti cose 
    % DEGREE -> prodotto più facilmente acquistabile per chi ha acquistato altri prodotti della stessa categoria, ossia quello che porterebbe piu probabili vendite se sponsorizzato all'interno della categoria)
    % DEGREE -> se pubblicizzo un prodotto con alto degree nel suo vicinato ho delle vendite facili molto probabili
    % CLOSENESS -> prodotto meglio posizionato per influenzare la sottorete piu velocemente -> ha senso sulla globalità? sfere di interesse del dataset?

\subsection{Analisi generale}
La rete che è stata costruita è mostrata in figura \ref{fig:reteCompleta}. Essa conta un totale di XXX componenti connesse, tra cui una giant component costituita da XXX nodi e XXX archi. \\
In figura \ref{fig:distribuzioneGradi} è mostrata la distribuzione dei gradi. Computando l'average degree si osserva che mediamente un prodotto tende ad essere connesso con altri XXX prodotti. Il coefficiente di clustering medio dell'intera rete è pari a XXX, quindi ...TODO?... La reciprocità è pari a XXX, quindi ...TODO?... La densità ha un valore di XXX, quindi ...TODO?... \\\\
%TODO: fig:reteCompleta
%TODO: fig:distribuzioneGradi
Calcolando il coefficiente di assortatività sull'intera rete si ottiene un valore di XXX che, essendo negativo, permette di asserire che la rete sia di tipo disassortativo. È infatti possibile osservare nel grafico in figura \ref{fig:assortativity} come i nodi hubs con grado più alto tendano a connettersi a nodi con grado basso. Da qui si può dire che nella rete sono più frequenti gli acquisti di prodotti con centralità di grado alta e in combinazione con prodotti di bassa centralità. Data la natura della rete, la rimozione di un prodotto hub potrebbe quindi portare ad isolare i prodotti del proprio vicinato. %TODO: mettere esempio? tipo tolgo olio di limone e separo corde... ihihi
%TODO: fig:assortativity con quel grafico K e K' che deve colorarsi su antidiagonale
%TODO: magari mettere foto di hubs disposti a cerchio con i vicini? oppure anche isolati così si vede che non comunicano essendo la rete disassortativa... oppure basta solo il grafico sopra
\\\\
%TODO: Prodotti centrali rete completa (degree/closeness)... ha senso anche prendere top X prodotti hub che hanno piu interazioni per capire a cosa gira intorno la porzione di amazon ?
Per quanto riguarda i prodotti più centrali della rete i top XXX per la misura di YYY sono:
\begin{enumerate}
    \item x
    \item y
    \item z
\end{enumerate}
Questo ci permette di capire che nel dataset dei prodotti ...TODO?....


\subsection{Analisi categorie}
Dopo aver osservato la rete nella sua globalità si è deciso di osservare le interazioni tra i prodotti dividendo la rete rispetto alle categorie. I risultati mostrati sono quelli relativi alle categorie più grandi in quanto, avendo a disposizione una porzione non bilanciata del dataset dei prodotti di amazon, sono le più significative. \\
In tabella \ref{tab:categoriesStats} sono disponibili le statistiche estratte per le prime XXX categorie più popolate. Per ogni categoria viene indicato il totale dei prodotti che raccoglie e il prodotto più centrale rispetto al grado ...e basta?...
%TODO: tab:categoriesStats con le top X categorie (Prodotto centrale di ogni categoria.. forse betweenness=closenessin questi casi)

%TODO: non so se mettere un piccolo esempio concreto in modo discorsivo... magari no


%TODO: paragrafetto che dice che categorie sparse qua e là, a volte si dividono in piu componenti connesse, quindi è piu utile effettuare Community detection -> passiamo in modo smooooth alla sezione successiva
Osservando la figura \ref{fig:reteCompletaCategorie} si può notare come una divisione della rete in categorie non sia la scelta migliore, in quanto sono riscontrabili le presenze di una stessa categoria che si divide tra diverse componenti connesse (esempio?) o di diverse categorie che formano gruppi compatti (esempio?). % probabilmente l'ho detta un po' male ma non mi viene la frase
%TODO: fig:reteCompletaCategorie
Per questo motivo, come si vedrà nella sezione successiva, è piu utile effettuare community detection sulla rete per individuare i reali gruppi di prodotti che si formano in base alle relazioni di acquisto.

\subsection{Analisi communities}
Le communities della rete sono state individuate mediante l'algoritmo Clauset-Newman-Moore greedy modularity maximization. Tramite questo algoritmo sono state trovate XXX communities. Il numero elevato era prevedibile data la grande quantità di componenti connesse pari a XXX. Si è osservato, inoltre, che le communities più rilevanti, fanno tutte parte della giant component che ne contiene XXX. \\
%TODO: dire se generalmente le community sono monocategoria...?
Come per le categorie, i risultati mostrati sono quelli relativi alle communities più importanti. 
\\\\
In tabella \ref{tab:communitiesStats} sono disponibili le statistche estratte per le prime XXX communities. \\
Oltre a fornire la cardinalità e gli elementi centrali come per le categorie, per ogni community è stato calcolato il coefficiente di clustering medio per determinare il livello di coesione.  Inoltre ci si è posti l'obiettivo di identificare la sfera di interesse di ogni gruppo di prodotti e di darne una sorta di etichetta che possa riassumerne il contenuto. A tale scopo sono stati calcolati i seguenti campi:
\begin{itemize}
    \item \textbf{dominant category}: categoria dominante della community; calcolata %TODO: zscore by rpo il bibliografo
    \item \textbf{categories distribution}: distribuzione delle categorie principali presenti nella community
    \item \textbf{top words}: parole più frequenti presenti nei titoli dei prodotti di una community; %TODO: RPO dire qualcosa sul come?
    \item \textbf{top entities}: entità più frequenti estratte tramite entity recognition dai titoli dei prodotti di una community; %TODO: RPO dire qualcosa sul come?
\end{itemize}
%TODO tab:communitiesStats tabella con le top X communities (qualche coefficiente tipo AVG intra/inter-clustering/silouhette?)
Nelle figure \ref{fig:wordCloudWords} e \ref{fig:wordCloudEntities} si trovano ... che suggeriscono che l'argomento della community è ...... \\\\
%TODO: mettere un piccolo esempio concreto tra i top parlando del vicinato e dell'importanza del prodotto centrale...
